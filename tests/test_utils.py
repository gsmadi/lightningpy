
from pylnd.utils import encode_macaroon, read_file

MACAROON_PATH = 'tests/fake/admin.macaroon'

FAKE_MACAROON = b'0201036c6e6402efbfbd01030a10efbfbd2fefbfbdefbfbd0cefbfbd58efbfbdefbfbdefbfbdefbfbdefbfbd55efbfbd55511201301a160a0761646472657373120472656164120577726974651a130a04696e666f120472656164120577726974651a170a08696e766f69636573120472656164120577726974651a160a076d657373616765120472656164120577726974651a170a086f6666636861696e120472656164120577726974651a160a076f6e636861696e120472656164120577726974651a140a057065657273120472656164120577726974651a120a067369676e6572120867656e657261746500000620efbfbd6744efbfbdefbfbdefbfbdefbfbdefbfbdefbfbd08360b053b1eefbfbdefbfbdefbfbd76efbfbdefbfbd7063482befbfbdefbfbdefbfbd5fefbfbdefbfbdefbfbd'

def test_macaroon_encoding():
    macaroon = read_file(MACAROON_PATH)
    encoded_macaroon = encode_macaroon(macaroon)

    assert isinstance(encoded_macaroon, bytes)
    assert encoded_macaroon == FAKE_MACAROON